# OTA Server
Сервер контроля версий прошивок для OTA (Over The Air) обновлений.

Компиляция:
```bash
go build
```

Конфигурация должна находиться в файле `config.ini`, пример есть в `config.ini.example`.

Запуск сервера:
```bash
./ota_server
```

Сервер сохраняет данные в папку, указанную в конфиге.
В этой папке хранится sqlite база данных с информацией о каждой версии и файлы прошивок.

## API
По адресу `/swagger/index.html` можно найти документацию к API.

Разработчики могут загружать новые версии прошивки.
Дополнительная информация, которую необходимо предоставить для каждой прошивке включает в себя:
* время сборки
* номер коммита в гите
* название репозитория
* тег из букв и цифр (может быть пустым)
* описание (может быть пустым)

Платы могут запрашивать последнюю версию прошивки, при этом должно быть предоставлено имя
репозитория. Также могут быть указаны теги, тогда будет найдена последняя версия прошивки с одним из
этих тегов. Если же теги не предоставлены, то выбирается самая новая версия среди всех, относящихся
к данному репозиторию.

## Безопасность
Для использование HTTP API нужно сгенерировать JWT токены.
Они содержат имя субъекта, на которого подписывается токен, и его тип (разработчик/плата).
Секретный ключ должен быть указан в конфигурации.

Токен для разработчика (даёт доступ ко всему API):
```
./ota_server token %USERNAME%
```

Токен для платы (даёт доступ только к получению последней версии прошивки):
```
./ota_server token %BOARDNAME% -b
```
